---
title: マルチターン会話
translationKey: multi-turn-conversation
description: AIチャットボットと自動化におけるマルチターン会話について学びます。AIシステムがコンテキスト、状態、複数のやり取りを管理し、複雑なタスクを処理する方法を理解します。
keywords:
- マルチターン会話
- AIチャットボット
- 対話型AI
- 対話管理
- コンテキスト保持
category: General
type: glossary
date: '2025-12-19'
lastmod: '2025-12-19'
draft: false
e-title: Multi-Turn Conversation
term: マルチターンかいわ
url: "/ja/glossary/Multi-turn-Conversation/"
---
## マルチターン会話とは?

マルチターン会話とは、ユーザーとAIシステムの間で行われる対話で、複数の交換または「ターン」で構成されるインタラクションです。各ターンは、ユーザー入力とシステム応答のペアです。マルチターン会話により、AIは旅行予約、トラブルシューティング、オンボーディングなどの目標を達成するために、複数のステップにわたって情報を収集または明確化する必要があるシナリオを処理できます。

シングルターンのインタラクションとは異なり、システムは以前のターンからの情報を記憶して使用し、会話の状態を管理し、曖昧さや中断に適応する必要があります。この機能は、現実的で役立つ、人間らしい自動化されたインタラクションに不可欠です。

## マルチターン会話が重要な理由

**複雑なタスク:** 多くのユーザーの目標には、単一のプロンプト-レスポンスのペアでは処理できない複数のデータポイント、ステップ、または決定が含まれます。

**自然な対話:** ユーザーは、代名詞を使用し、以前の回答を参照し、すべてを言い直すことなく自分自身を訂正するなど、会話的にシステムと対話することを期待しています。

**カスタマーエクスペリエンス:** 質問を繰り返さず、コンテキストを自然に処理し、シームレスな体験を提供することで、ユーザーのフラストレーションを回避します。

**非線形インタラクション:** 人間の会話と同様に、トピックの変更、明確化、フロー途中での修正をサポートします。

**主な利点:**
- タスク完了率の向上
- 顧客満足度(CSAT)の改善
- より堅牢な自動化
- 人間らしいデジタル体験

## 技術的コンポーネント

### コンテキスト保持

システムは、以前のターンからの関連する詳細(目的地、日付、ユーザーの好み)を保存し、後の応答に情報を提供します。これにより、参照解決(例:「それを予約して」または「時間を変更して」)が可能になります。

### 対話/状態管理

ユーザーがどのステップにいるか、どのスロット(情報フィールド)が埋められているか、まだ何が必要かを追跡します。

### スロットフィリング

複数のターンにわたって必要な情報(日付、場所、座席クラス)を収集し、必要に応じて検証します。

### 明確化プロンプト

欠落している、または曖昧な詳細を尋ねます(「今週の金曜日ですか、それとも来週の金曜日ですか?」)。

### エラー回復

誤解、不正確な回答、または中断を処理し、再プロンプトまたは適切に再起動します。

### コンテキスト有効期限

保存されたデータをいつリセットまたはクリアするか(タスク完了後または非アクティブ後)を認識します。

## 対話の例

**シナリオ: チャットボット経由でのフライト予約**

```
User: I'd like to book a flight.
Bot: Sure! Where would you like to fly to?
User: London.
Bot: Great, what date do you plan to travel?
User: Next Friday.
Bot: Do you need a return ticket as well?
User: Yes, returning Sunday.
Bot: Booking a flight to London leaving next Friday, returning Sunday. Is this correct?
User: Yes.
Bot: Your flight has been booked. Confirmation sent to your email.
```

**分析:**
- チャットボットは複数のターンにわたって目的地と日付を保持
- ユーザーが曖昧な入力をした場合、ボットは明確化できる
- ユーザーが気が変わった場合、システムはコンテキストを更新してフローを続行

## ユースケース

**カスタマーサービス:** 返品、返金、トラブルシューティング、注文状況、ガイド付き問題解決。

**営業とリード資格認定:** 顧客要件の収集、デモのスケジューリング、異議処理。

**予約スケジューリング:** 時間/日付、場所、確認の収集。

**オンボーディング/登録:** ステップバイステップのアカウント作成、KYC、またはドキュメントアップロード。

**テクニカルサポート:** 一連の質問を通じて問題を絞り込むガイド付きトラブルシューティング。

**Eコマース:** 製品推奨、購入フロー、配送オプション。

**人事とITヘルプデスク:** 複数ステップのチケット作成、オンボーディング、FAQ。

## 実装アプローチ

### コンテキスト管理

**インメモリストレージ:** 各ターンからの重要な詳細をセッションメモリまたはデータベースに保存します。

**LLMベースのコンテキスト:** モデルのコンテキストウィンドウまで各プロンプトにチャット履歴を追加します。

**実現:** フォローアップと参照(例:「明日予約して」は以前の目的地と日付を使用)。

### 対話状態追跡

**ステートマシン:** フローチャートまたはストーリーベースのシステムを使用して、会話内のユーザーの位置を追跡します。

**サポート:** ユーザーが明確化の質問をしたり、気が変わったり、新しいリクエストを挿入したりする可能性がある非線形フロー。

### スロットフィリング

**必須スロットの定義:** 各タスク(フライト予約の目的地、日付、座席クラス)に対して。

**ボットの動作:** 欠落しているスロットをプロンプトし、エントリを検証し、すべて完了したら確認します。

**フレームワークサポート:** Dialogflow、Rasa、Lexは組み込みのスロットフィリングと検証を提供します。

### エラー回復

**検出:** 曖昧または一貫性のない応答を識別します。

**応答:** 明確化をプロンプトし、一時停止、分岐、または再起動によって中断を処理します。

**コンテキスト有効期限:** 古いまたは無関係な情報に基づいて行動することを回避します。

### ナレッジベースの構造化

**階層的組織:** 見出し/小見出しにより、フォローアッププロンプトと論理的なフローが可能になります。

**プラットフォームサポート:** Microsoft QnA MakerとAzure Language Serviceは、構造化されたドキュメントからマルチターンフローを自動的に抽出できます。

## 一般的な課題

**コンテキストの喪失:** ボットは、特に会話がモデルのコンテキストウィンドウまたはメモリ制限を超える場合、以前の情報を忘れる可能性があります。

**コンテキストウィンドウの制限:** LLMには最大コンテキストウィンドウ(8Kまたは32Kトークン)があるため、長い会話では切り捨てまたは要約が必要になる場合があります。

**予期しないトピックの変更:** ユーザーはトピック間をジャンプできるため、動的な状態管理が必要です。

**曖昧な応答:** 曖昧な入力はフローを脱線させる可能性があり、明確化プロンプトが必要です。

**繰り返しの質問:** 状態処理が不十分だと、ボットが不必要に質問を繰り返します。

**エラーの伝播:** 初期のミスが連鎖し、会話の後半で混乱を招きます。

**一貫性:** ターン全体で事実とペルソナの一貫性を維持することは大きな課題です。

## ベストプラクティス

**会話フローのマッピング:** フローチャート/ストーリーボードを使用して、代替フローとエラーフローを含む各パスを設計します。

**スロットフィリングと検証:** 必要な情報が収集、検証、確認されてから進むことを確認します。

**コンテキスト有効期限ルール:** 非アクティブ、タスク完了、または明示的なユーザーリクエストでコンテキストを自動的にクリアします。

**適切なトピックシフト:** ユーザーがトピックを変更する際に、ボットが一時停止、切り替え、またはフローを再開できるようにします。

**曖昧さの明確化:** 必要に応じて明確化を求めるコンテキスト対応プロンプトを使用します。

**ステートレスターン設計:** 可能な限り、各ターンをステートレス関数として扱い、各プロンプトで必要なすべてのコンテキストを渡します。

**徹底的なテスト:** 実際のユーザー行動、中断、非線形パスをシミュレートします。

**階層的KBの活用:** 構造化されたドキュメントを使用してフォローアッププロンプトを定義し、論理的なフローを維持します。

**監視と反復:** ログを分析して障害を特定し、フロー、プロンプト、状態管理を継続的に改善します。

## ツールとフレームワーク

**Microsoft QnA Maker / Azure AI Language Service:** 構造化されたドキュメントからマルチターンフローを抽出し、APIベースのフォローアッププロンプト。

**Dialogflow CX (Google Cloud):** ステートフルフローで複雑な複数ステップの会話を管理します。

**Rasa:** オープンソース、対話状態とスロットフィリングのためのストーリー/ルールをサポート。

**Amazon Lex:** セッション属性とスロット管理を提供します。

**PromptLayer:** ステートレスマルチターンチャット、プロンプト評価、体系的なテスト。

**Sendbird Agentic AI:** マルチターン会話のテストと分析。

**Bot Framework Composer (Microsoft):** マルチターン対話を構築/テストするためのビジュアルデザインツール。

## サマリーテーブル

| 機能 | 目的 | 例 / ソリューション |
|---------|---------|-------------------|
| **コンテキスト保持** | ステップ全体でユーザー入力を記憶 | 予約中に目的地と日付を保存 |
| **対話状態追跡** | プロセス内のユーザーの位置を認識 | 「ステップ2: フライトの選択」 |
| **スロットフィリング** | 必要なデータを収集 | 目的地の後に帰りの日付を尋ねる |
| **明確化プロンプト** | 欠落/曖昧な情報を処理 | 「日付を確認していただけますか?」 |
| **コンテキスト有効期限** | タスク終了時にコンテキストをクリア | 予約確認後にリセット |
| **エラー回復** | 誤解から回復 | 不明確な質問を繰り返すまたは言い換える |
| **トピック変更処理** | 新しいリクエストに適応 | ユーザーがリクエストした場合、現在のフローを一時停止し、新しいタスクを開始 |

## 参考文献


1. Sendbird. (n.d.). What are Multi-turn Conversations?. Sendbird Blog.

2. Microsoft. (n.d.). Multi-turn Conversations - QnA Maker. Microsoft Learn.

3. Retell AI. (n.d.). Multi-Turn Conversation. Retell AI Glossary.

4. Vapi AI. (n.d.). Multi-turn Conversations. Vapi AI Blog.

5. DataStudios. (n.d.). How Chatbots Handle Follow-up Questions: Multi-Turn Dialogue Explained. DataStudios.

6. PromptLayer. (n.d.). Multi-Turn Chat. PromptLayer Documentation.

7. Maxim AI. (n.d.). How to Ensure Consistency in Multi-Turn AI Conversations. Maxim AI Articles.

8. OpenAI Community. (n.d.). Multi-turn Conversation Best Practice. OpenAI Community Forum.

9. Microsoft. (n.d.). Conceptual Bot Design. Microsoft Bot Builder.

10. Sendbird. (n.d.). Multi-turn Conversation Testing Framework. Sendbird Blog.

11. PromptLayer. (n.d.). Evaluating Multi-Turn AI. PromptLayer Blog.

12. YouTube. (n.d.). QnA Maker Multi-turn Example. YouTube.
