---
title: 決定木
date: 2025-12-19
translationKey: Decision-Tree
description: 機械学習における決定木の包括的ガイド。アルゴリズム、実装方法、メリット、データサイエンスにおける実際の応用例を網羅しています。
keywords:
- 決定木
- 機械学習
- 分類
- 回帰
- データマイニング
category: Application & Use-Cases
type: glossary
draft: false
e-title: Decision Tree
url: /ja/glossary/decision-tree/
aliases:
- /ja/glossary/Decision-Tree/
term: けっていき
---

## 決定木とは何か?
決定木は、意思決定とその結果を木構造の形式でモデル化する基本的な機械学習アルゴリズムです。この強力な予測モデリング技術は、フローチャートのような表現を使用し、各内部ノードが属性のテストを表し、各枝がテストの結果を表し、各葉ノードがクラスラベルまたは数値を表します。このアルゴリズムは、最も情報量の多い特徴に基づいてデータセットを再帰的に分割し、予測につながるif-else条件の階層的なセットを作成することで機能します。

決定木の美しさは、その解釈可能性と直感的な性質にあり、技術者と非技術者の両方のステークホルダーにとって最もアクセスしやすい機械学習アルゴリズムの1つとなっています。ニューラルネットワークのようなブラックボックスモデルとは異なり、決定木は明確な推論経路を提供し、ドメインエキスパートによって容易に理解され検証されます。木構造は人間の意思決定プロセスを反映しており、私たちは自然に異なる要因とその組み合わせを考慮して結論に達します。この透明性により、決定木は医療、金融、法律などの説明可能性が重要な領域で特に価値があります。

決定木は分類タスクと回帰タスクの両方を処理できるため、機械学習ツールキットの中で汎用性の高いツールとなっています。分類問題では、木は離散的なクラスラベルを予測し、回帰タスクでは連続的な数値を予測します。このアルゴリズムは、広範な前処理を必要とせずにカテゴリカル特徴と数値特徴の両方を扱うことができ、欠損値や非線形関係を自然に処理します。現代の実装には、過学習を防ぐための剪定、パフォーマンス向上のために複数の木を組み合わせるランダムフォレストや勾配ブースティングなどのアンサンブル手法、異なる目的に最適化する高度な分割基準などの洗練された技術が含まれています。

## コアアルゴリズムとアプローチ

**ID3(Iterative Dichotomiser 3)**<!-- -->は、情報利得を分割基準として使用する最も初期の決定木アルゴリズムの1つです。カテゴリカル特徴のみで動作し、各ノードで最も高い情報利得を提供する属性を選択し、クラスを最もよく分離する特徴を効果的に選択します。

**C4.5**は、カテゴリカル属性と連続属性の両方を処理することでID3を拡張し、より多くの値を持つ特徴へのバイアスに対処するために利得比を組み込んでいます。また、過学習を減らすための事後剪定技術を含み、前身よりも効果的に欠損値を処理できます。

**CART(Classification and Regression Trees)**<!-- -->は、分類にはジニ不純度を、回帰には平均二乗誤差を分割基準として使用します。バイナリ分割のみを作成し、組み込みの剪定メカニズムを含むため、堅牢なパフォーマンスで分類タスクと回帰タスクの両方に適しています。

**CHAID(Chi-squared Automatic Interaction Detection)**<!-- -->は、カイ二乗検定を使用して最適な分割を決定し、バイナリだけでなく多方向の分割を作成できます。カテゴリカルなターゲット変数に特に効果的で、分割の統計的有意性検定を提供します。

**ランダムフォレスト**は、ブートストラップ集約(バギング)とランダム特徴選択を使用して複数の決定木を組み合わせます。各木は異なるデータと特徴のサブセットで訓練され、最終的な予測はすべての木にわたる平均化(回帰)または投票(分類)によって行われます。

**勾配ブースティング木**は、各新しい木が以前の木によって犯されたエラーを修正する形で、木を順次構築します。このアンサンブル手法は、困難なケースに焦点を当て、モデルの精度を徐々に向上させることで、優れた予測パフォーマンスを達成することがよくあります。

**XGBoostとLightGBM**は、正則化、効率的なメモリ使用、並列処理などの高度な最適化を含む勾配ブースティングの現代的な実装を表しています。これらのアルゴリズムは、その卓越したパフォーマンスと速度により、機械学習コンペティションを支配することがよくあります。

## 決定木の動作原理

**ステップ1:データ準備と初期設定**
アルゴリズムは、ルートノードで訓練データセット全体から始まります。すべてのサンプルと特徴が考慮可能であり、ターゲット変数の分布が分析されてベースライン予測精度が理解されます。

**ステップ2:特徴選択と分割基準**
利用可能な各特徴について、アルゴリズムは潜在的な分割点を評価します。カテゴリカル特徴の場合、カテゴリの異なるグループ化を考慮します。数値特徴の場合、データを意味のあるサブセットに分割できるさまざまな閾値を検討します。

**ステップ3:不純度の計算**
アルゴリズムは、各潜在的な分割について不純度測定値(ジニ不純度、エントロピー、平均二乗誤差など)を計算します。これらの測定値は、結果として得られる各サブセット内でターゲット変数がどれだけ混在しているかを定量化し、不純度が低いほど分離が良好であることを示します。

**ステップ4:最適分割の選択**
不純度の最大の減少(最高の情報利得)をもたらす分割が選択されます。これにより、各分割が親ノードよりもターゲット変数に関してより均質なサブセットを作成することが保証されます。

**ステップ5:ノードの作成とデータの分割**
選択された分割により子ノードが作成され、データはそれに応じて分割されます。各データのサブセットは、分割条件を満たすサンプルのみを運んで、対応する子ノードに移動します。

**ステップ6:再帰的分割プロセス**
アルゴリズムは、各子ノードに同じプロセスを再帰的に適用し、そのデータのサブセットの新しいルートとして扱います。これは、最大深度への到達、ノードあたりの最小サンプル数、または純粋なノードの達成などの停止基準が満たされるまで続きます。

**ステップ7:葉ノードの割り当て**
ノードがこれ以上分割できない場合、それは葉ノードになります。分類の場合、葉にはそのサンプルの多数派クラスが割り当てられます。回帰の場合、そのサンプルのターゲット変数の平均値が割り当てられます。

**ステップ8:剪定と最適化**
剪定などの後処理技術は、検証データでパフォーマンスを大幅に改善しない枝を削除します。これにより、過学習を防ぎ、より汎化可能なモデルを作成できます。

**ワークフローの例:**収入、クレジットスコア、雇用状況に基づいてローン承認を予測することを考えます。木は最初にクレジットスコア(>650)で分割し、次に高クレジット申請者を収入(>$50,000)で分割し、最後にエッジケースの雇用状況を考慮し、ローン担当者のための明確な決定経路を作成する可能性があります。

## 主な利点

**解釈可能性と説明可能性**により、ステークホルダーが予測の背後にある推論を理解する必要がある場合、決定木は非常に価値があります。木構造は、ドメインエキスパートによって容易に伝達され検証できる明確で論理的な経路を提供します。

**データ前処理が不要**により、決定木は正規化、スケーリング、エンコーディングなしにカテゴリカル特徴と数値特徴の両方を直接処理できます。これにより準備時間が短縮され、特徴の元の意味が維持されます。

**欠損値を自然に処理**代理分割と代替経路を通じて、アルゴリズムを不完全なデータセットに対して堅牢にします。木は、一部の特徴が時々利用できない場合でもパターンを学習できます。

**ノンパラメトリックな性質**は、決定木が基礎となるデータ分布について仮定を行わないことを意味し、パラメトリックモデルが見逃す可能性のある複雑な非線形関係に適しています。

**特徴選択機能**は、予測に最も重要な特徴を自動的に識別します。情報量の多い特徴のみが分割に選択されるためです。これにより、どの変数がターゲット結果を駆動するかについての洞察が得られます。

**予測時の計算効率**により、決定木はリアルタイムアプリケーションに高速です。一度訓練されると、予測を行うには木構造を通る単純な経路をたどるだけです。

**分類と回帰の両方を処理**同じ基本的なアプローチで、決定木を一貫した方法論でさまざまなタイプの予測問題に対処できる汎用性の高いツールにします。

**外れ値に対して堅牢**分割が絶対値ではなく特徴のランキングに基づいているため、他のアルゴリズムを歪める可能性のある極端な値の影響が軽減されます。

**スケーラビリティ**により、決定木は大規模なデータセットを効率的に処理でき、特にメモリ使用と並列処理の最適化を含む現代の実装では効果的です。

**アンサンブルの基盤**により、決定木はランダムフォレストや勾配ブースティングなどのより洗練されたアルゴリズムの構成要素として機能でき、これらはしばしば最先端のパフォーマンスを達成します。

## 一般的なユースケース

**医療診断システム**は、決定木を使用して医師が従うことができる診断プロトコルを作成し、症状、検査結果、患者の病歴を組み込んで、可能性の高い状態と治療経路を提案します。

**信用リスク評価**は、決定木を使用してローン申請を評価し、収入、信用履歴、負債対収入比率、雇用の安定性などの要因を考慮して、承認の可能性と金利を決定します。

**顧客セグメンテーション**は、決定木を使用して、人口統計、購買行動、好みに基づいて明確な顧客グループを識別し、ターゲットを絞ったマーケティング戦略とパーソナライズされた体験を可能にします。

**不正検出**は、決定木を適用して、支出行動、位置データ、取引金額、タイミングのパターンを分析することで疑わしい取引を識別し、潜在的に不正な活動にフラグを立てます。

**製造における品質管理**は、決定木を実装して、製造パラメータ、環境条件、材料特性に基づいて製品の欠陥を予測し、積極的な品質管理を可能にします。

**マーケティングキャンペーンの最適化**は、決定木を活用して、さまざまなマーケティングチャネル、メッセージ、タイミングに対する顧客の反応を予測し、キャンペーンの効果と投資収益率を最大化します。

**人事と採用**は、決定木を使用して求職者をスクリーニングし、従業員のパフォーマンスを予測し、従業員の定着と満足度に寄与する要因を識別します。

**サプライチェーン管理**は、決定木を適用して在庫レベルを最適化し、需要の変動を予測し、配送時間とコストに影響を与える要因を識別します。

**環境モニタリング**は、決定木を使用して環境条件を予測し、汚染レベルを評価し、センサーデータと履歴パターンに基づいて生態学的変化に寄与する要因を識別します。

**スポーツ分析**は、決定木を利用して、履歴データ、選手の統計、状況要因に基づいて試合結果、選手のパフォーマンス、最適な戦略を予測します。

## アルゴリズム比較表

| アルゴリズム | 分割基準 | データタイプ | 剪定 | アンサンブル対応 | 最適なユースケース |
|-----------|-------------------|------------|---------|----------------|---------------|
| ID3 | 情報利得 | カテゴリカルのみ | なし | 限定的 | 教育/シンプルな分類 |
| C4.5 | 利得比 | 混合タイプ | あり | 中程度 | 混合データを使用した一般的な分類 |
| CART | ジニ/MSE | 混合タイプ | あり | 優秀 | 本番システム、アンサンブルベース |
| CHAID | カイ二乗 | カテゴリカル重視 | 限定的 | なし | 市場調査、カテゴリカル分析 |
| ランダムフォレスト | ジニ/MSE(アンサンブル) | 混合タイプ | 暗黙的 | ネイティブ | 高性能分類/回帰 |
| XGBoost | 勾配ベース | 混合タイプ | 高度 | ネイティブ | コンペティション、複雑なパターン認識 |

## 課題と考慮事項

**過学習の傾向**は、木が深く成長しすぎて、汎化可能なパターンを学習するのではなく訓練データを記憶する場合に発生します。これにより、新しい未見のデータでのパフォーマンスが低下し、停止基準と剪定技術の慎重な調整が必要になります。

**より多くの値を持つ特徴へのバイアス**により、アルゴリズムが多くのカテゴリを持つカテゴリカル特徴や連続特徴を優先し、データ内のより単純だがより意味のあるパターンを見落とす可能性があります。

**不安定性と高分散**は、訓練データの小さな変化が大幅に異なる木構造をもたらす可能性があることを意味し、類似したデータセット間で一貫した予測を行うために個々の木を信頼できなくします。

**線形関係の困難**は、決定木が長方形の決定境界を作成するために発生し、他のアルゴリズムが自然に処理する単純な線形または滑らかな非線形関係を捉えるのに非効率的になります。

**限定的な外挿能力**は、決定木が回帰モデルのように観測された特徴空間を超えて外挿できないため、訓練データの範囲内で予測を行うことに制限されます。

**訓練の計算複雑性**は、大規模なデータセットと多くの特徴を持つ場合に法外になる可能性があります。アルゴリズムは木の構築中に各ノードで多数の潜在的な分割を評価する必要があるためです。

**クラス不均衡への感度**により、決定木が多数派クラスに偏る可能性があり、アプリケーションにとって重要である可能性のある少数派クラスの重要なパターンを無視する可能性があります。

**特徴相互作用の制限**により、決定木が木の階層的分割構造と一致しない特徴間の複雑な相互作用を捉えることが困難になります。

**メモリ要件**は、特に本番展開のために完全な木構造と関連するメタデータを保存する場合、大きな木では相当なものになる可能性があります。

**ハイパーパラメータの感度**は、特定のデータセットと問題に対して最適なパフォーマンスを達成するために、最大深度、葉あたりの最小サンプル数、分割基準などのパラメータの慎重な調整を必要とします。

## 実装のベストプラクティス

**モデル選択のための交差検証**は、複数のデータ分割でモデルをテストすることにより、堅牢なパフォーマンス推定を保証し、最適なハイパーパラメータを識別し、特定の訓練-テスト分割への過学習を回避するのに役立ちます。

**適切な訓練-検証-テスト分割**は、訓練、ハイパーパラメータ調整、最終的なパフォーマンス評価に別々のデータセットを使用することでデータの整合性を維持し、データリークを防ぎ、偏りのない結果を保証します。

**特徴エンジニアリングと選択**は、意味のある派生特徴を作成し、無関係な変数を削除し、木の構築前にカテゴリカル変数を適切に処理することで、モデルのパフォーマンスを向上させます。

**ハイパーパラメータ調整**は、グリッドサーチやランダムサーチなどの技術を使用して、最大深度、分割あたりの最小サンプル数、分割基準などのパラメータを体系的に探索することで、モデルのパフォーマンスを最適化します。

**剪定戦略の実装**は、コスト複雑性剪定や縮小誤差剪定などの技術を使用して、検証パフォーマンスを大幅に改善しない枝を削除することで過学習を防ぎます。

**クラス不均衡の処理**は、クラスの重み付け、少数派クラスのオーバーサンプリング、または木の構築中の層別サンプリングの使用などの技術を通じて、歪んだターゲット分布に対処します。

**アンサンブル手法の統合**は、単一の木に依存するのではなく、バギング(ランダムフォレスト)またはブースティング(勾配ブースティング)を通じて複数の木を組み合わせることで、パフォーマンスと安定性を向上させます。

**欠損値戦略**は、訓練前の補完または分割中に欠損値を自然に処理するアルゴリズムの使用のいずれかを通じて、欠損データを処理するための一貫したアプローチを開発します。

**パフォーマンスモニタリングと検証**は、適切なメトリクスを使用してモデルのパフォーマンスの継続的な評価を確立し、本番環境でのコンセプトドリフトまたは劣化を監視します。

**ドキュメントと解釈可能性**は、必要に応じてステークホルダーの理解と規制遵守を可能にするために、モデルの決定、特徴の重要性、木構造の明確なドキュメントを維持します。

## 高度な技術

**アンサンブル手法とスタッキング**は、ツリー出力がメタ学習者への入力として機能する多層スタッキングを含む、洗練された集約技術を使用して複数の決定木モデルを組み合わせ、予測パフォーマンスを向上させます。

**勾配ブースティングのバリエーション**は、正則化、効率的なメモリ使用、カテゴリカル特徴の特殊な処理を組み込んだAdaBoost、XGBoost、LightGBM、CatBoostなどの高度なブースティングアルゴリズムを実装します。

**多出力決定木**は、複数のターゲット変数を同時に予測するために従来の木を拡張し、出力間で木構造を共有し、異なる予測タスク間の相関を捉えます。

**斜め決定木**は、単一特徴の閾値ではなく特徴の線形結合を使用して分割を作成し、高次元データの複雑なパターンをよりよく捉えることができるより柔軟な決定境界を可能にします。

**確率的決定木**は、葉ノードで確率分布を維持し、木構造を通じて不確実性を伝播することで不確実性の定量化を組み込み、より堅牢な予測を行います。

**オンラインおよび増分学習**は、新しいデータが到着するにつれてモデルが継続的に更新する必要があるストリーミングデータシナリオに決定木を適応させ、Hoeffding木や増分分割基準などの技術を使用します。

## 今後の方向性

**ディープラーニング統合**は、決定木とニューラルネットワークを組み合わせたハイブリッドアプローチを探求し、特徴選択と解釈可能性に木を使用しながら、複雑なパターン認識にディープラーニングを活用します。

**自動機械学習(AutoML)**<!-- -->は、決定木を自動モデル選択とハイパーパラメータ最適化パイプラインに組み込み、高度な木ベースの手法を非専門家がアクセスできるようにします。

**量子決定木**は、決定木アルゴリズムへの量子コンピューティングアプリケーションを調査し、特定のタイプの分類と最適化問題に対して指数関数的な高速化を提供する可能性があります。

**連合学習アプリケーション**は、データを集中化できない分散学習シナリオに決定木アルゴリズムを適応させ、プライバシーを保持しながら協調的なモデル訓練を可能にします。

**因果推論統合**は、単なる相関ではなく因果関係を識別できる決定木のバリエーションを開発し、政策と介入シナリオにおけるより堅牢な意思決定をサポートします。

**説明可能なAIの強化**は、より優れた可視化ツール、反事実的説明、より広範な説明可能なAIフレームワークとの統合を含む、木ベースのモデルの解釈可能性技術を進歩させます。

## 参考文献

1. Breiman, L., Friedman, J., Stone, C. J., & Olshen, R. A. (1984). Classification and Regression Trees. CRC Press.

2. Quinlan, J. R. (1993). C4.5: Programs for Machine Learning. Morgan Kaufmann Publishers.

3. Hastie, T., Tibshirani, R., & Friedman, J. (2009). The Elements of Statistical Learning: Data Mining, Inference, and Prediction. Springer.

4. Chen, T., & Guestrin, C. (2016). XGBoost: A Scalable Tree Boosting System. Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining.

5. Breiman, L. (2001). Random Forests. Machine Learning, 45(1), 5-32.

6. Rokach, L., & Maimon, O. (2014). Data Mining with Decision Trees: Theory and Applications. World Scientific Publishing.

7. Zhou, Z. H. (2012). Ensemble Methods: Foundations and Algorithms. CRC Press.

8. Molnar, C. (2020). Interpretable Machine Learning: A Guide for Making Black Box Models Explainable. Lulu Press.