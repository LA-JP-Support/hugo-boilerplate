---
title: モデル窃取
date: 2025-01-11
translationKey: model-stealing-attack
description: モデル窃取は、機械学習モデルにクエリを送信し、その応答を使用してレプリカをトレーニングすることでモデルの機能を抽出するセキュリティ攻撃です。知的財産を脅かし、さらなる攻撃を可能にします。
keywords:
- モデル窃取
- モデル抽出
- 機械学習セキュリティ
- API攻撃
- 知的財産
- AIセキュリティ
category: AI Chatbot & Automation
type: glossary
draft: false
e-title: Model Stealing
url: /ja/glossary/model-stealing/
term: もでるせっしゅ
---

## モデル窃取とは何か？

モデル窃取（model stealing）は、モデル抽出（model extraction）とも呼ばれ、機械学習システムに対する攻撃の一種です。攻撃者は、ターゲットモデルに体系的にクエリを送信し、その応答を使用して代替モデルを訓練することで、ターゲットモデルの機能的なコピーを作成しようとします。

窃取されたモデルは、元の訓練データ、モデルアーキテクチャの詳細、または訓練済みパラメータにアクセスすることなく、元のモデルの動作と予測を再現できます。これにより、機械学習システムに組み込まれた知的財産を効果的に抽出することができます。

この攻撃は、機械学習APIとサービスの基本的な性質を悪用します。任意の入力に対して予測を提供することで、これらのシステムは意図せず内部の意思決定プロセスに関する情報を明らかにしてしまいます。攻撃者はこの情報漏洩を利用して、ターゲットモデルの機能を近似する代替モデルを訓練でき、比較的少数のクエリで高い忠実度を達成できる可能性があります。

モデル窃取は、複数の側面で重大な脅威をもたらします。独自の機械学習モデルの開発に多大なリソースを投資する組織の競争優位性を損ないます。攻撃者が使用制限や収益化メカニズムを回避することを可能にします。おそらく最も懸念されるのは、窃取されたモデルが、敵対的サンプル生成や[モデル反転](Model-Inversion.md)攻撃など、より高度な攻撃の足がかりとして機能する可能性があることです。攻撃者は検出されることなく代替モデルの内部を研究できるためです。

## モデル窃取の仕組み

**基本的な攻撃プロセス**

*クエリ選択*
- 攻撃者がターゲットモデルに送信する入力を選択
- ランダムサンプリング、戦略的選択、または能動学習を使用する場合がある
- 目標：クエリごとに得られる情報を最大化
- クエリ予算と再構築品質のバランスを取る必要がある

*応答収集*
- APIまたはインターフェースを通じてクエリを送信
- すべての予測、確率、信頼度スコアを記録
- 追加情報（レイテンシ、エラーメッセージ）を悪用する場合がある
- 入力-出力ペアのデータセットを構築

*代替モデルの訓練*
- 収集したデータを使用して代替モデルを訓練
- 元のアーキテクチャと一致する場合もしない場合もある
- ターゲットの動作に一致するように代替モデルを最適化
- 必要に応じて追加のクエリで反復

*検証と改良*
- 保留されたクエリで代替モデルをテスト
- ターゲットモデルとの一致度を測定
- 不一致に基づいてアプローチを改良
- 望ましい忠実度が達成されるまで継続

**攻撃の分類**

| 攻撃タイプ | 目標 | 要件 | 典型的な忠実度 |
|-------------|------|--------------|------------------|
| 機能的に等価 | 動作を一致させる | クエリアクセス | 90-99% |
| タスク精度 | 精度を一致させる | ラベルのみ | 80-95% |
| 近似 | 類似の動作 | 限定的なクエリ | 70-90% |
| アーキテクチャ抽出 | 構造を決定 | 複数のクエリタイプ | 変動 |

## 攻撃技術

**クエリベースのアプローチ**

*ランダムサンプリング*
- 入力ドメインからランダムな入力を生成
- シンプルだが多くのクエリが必要な場合がある
- 入力分布が不明な場合に機能
- 比較のためのベースラインアプローチ

*戦略的サンプリング*
- 決定境界にクエリを集中
- 不確実性サンプリングを使用して情報量の多い領域を見つける
- クエリ選択を最適化するための能動学習
- より少ないクエリでより良い忠実度を達成

*合成データ生成*
- 情報利得を最大化する入力を生成
- 生成モデルを使用して現実的なクエリを作成
- 入力ドメインの知識を活用
- クエリ要件を大幅に削減できる

**知識蒸留アプローチ**

*ソフトラベル訓練*
- 完全な確率分布をターゲットとして使用
- ハードラベルのみよりも多くの情報
- モデルの不確実性と関係を捉える
- 確率が利用可能な場合の標準的なアプローチ

*特徴マッチング*
- アクセス可能な場合は中間表現を一致させる
- 内部モデルの動作を捉える
- 追加のAPI機能が必要
- 利用可能な場合はより高い忠実度

**アーキテクチャ抽出**

*サイドチャネル分析*
- タイミング、メモリ、または電力の変動を悪用
- 計算パターンからアーキテクチャを推測
- 予測アクセスなしでも機能
- 物理的またはインフラストラクチャへのアクセスが必要

*メタモデルアプローチ*
- モデルのプロパティを予測する分類器を訓練
- アーキテクチャファミリー間を区別
- 既知のアーキテクチャのデータベースが必要
- 抽出のための検索空間を狭める

## 脆弱なシステム

**クラウドML API**
- APIを通じた簡単なクエリアクセス
- 完全な確率分布を返すことが多い
- レート制限が不十分な保護である可能性
- 商用モデルは価値あるターゲット

**ML-as-a-Serviceプラットフォーム**
- 予測エンドポイントが広くアクセス可能
- 標準インターフェースが攻撃を簡素化
- バッチ予測が効率的な抽出を可能にする
- 窃取の競争的動機

**エッジおよびモバイルモデル**
- デバイスへの物理的アクセス
- モデルが直接抽出可能な場合がある
- ランタイム分析が可能
- デプロイメントが露出を増加させる

**組み込みMLシステム**
- ML機能を持つIoTデバイス
- 限定的なセキュリティリソース
- 物理的アクセスが可能なことが多い
- リバースエンジニアリングが実行可能

## 攻撃の動機

**知的財産の窃取**

*商業的価値*
- 高価な訓練プロセスを回避
- ライセンス料を回避
- 窃取した技術で競争
- 開発コストを削減

*競争優位性*
- 競合他社の能力を理解
- 成功したモデルを複製
- 意思決定プロセスを分析
- 開発を加速

**さらなる攻撃の実現**

*敵対的サンプル生成*
- 代替モデルがホワイトボックス攻撃開発を可能にする
- 敵対的サンプルが元のモデルに転移
- 攻撃者が検出されずに反復できる
- ブラックボックス攻撃よりも効果的

*[モデル反転](Model-Inversion.md)*
- 代替モデルを訓練データについて分析できる
- ホワイトボックスアクセスがより強力な攻撃を可能にする
- プライバシー侵害が可能
- ターゲットシステムによる検出なし

*回避攻撃*
- モデルの弱点を理解
- 誤分類を引き起こす入力を作成
- セキュリティや不正検出を回避
- オフラインで回避戦略をテスト

**サービスの回避**

*収益化の回避*
- クエリごとの料金を回避
- レート制限を超える
- 使用制限を回避
- 無許可のコピーを作成

*アクセスの拡張*
- 許可された範囲を超えてモデルを使用
- 制限された環境にデプロイ
- 許可なく共有
- 派生物を作成

## 防御メカニズム

**クエリの監視と制限**

*レート制限*
- ユーザー/期間ごとのクエリを制限
- ユーザーごとに異なる制限
- 攻撃のコストと時間を増加させる
- 正当な使用とのバランスを取る必要がある

*異常検出*
- 疑わしいクエリパターンを識別
- 抽出スタイルの動作を検出
- 異常な入力分布にフラグを立てる
- 潜在的な攻撃を警告

*クエリログ*
- すべてのAPIクエリを追跡
- フォレンジック分析を可能にする
- 攻撃の試みを識別
- インシデント対応をサポート

**出力の摂動**

*信頼度のマスキング*
- 確率値を丸める
- トップkのみを返す
- 低信頼度の予測を保留
- 情報漏洩を削減

*応答の劣化*
- 出力にノイズを追加
- 同一入力に対して応答を変化させる
- 予測精度を低下させる
- 有用性とセキュリティのバランス

*ウォーターマーキング*
- モデルの動作に検出可能な署名を埋め込む
- 窃取されたコピーの識別を可能にする
- 法的執行をサポート
- モデルのパフォーマンスに影響を与える可能性

**アーキテクチャ防御**

*モデルの複雑性*
- 複雑なモデルは抽出が困難
- アンサンブルアプローチは抽出に抵抗
- 動的アーキテクチャは困難
- 効率性とのトレードオフ

*予測API設計*
- 応答の情報を最小化
- 不要なメタデータを避ける
- API設計でプライバシーを考慮
- セキュリティプロパティを文書化

**法的および政策的措置**

*利用規約*
- 抽出の試みを禁止
- 許容される使用を定義
- 法的手段を確立
- 執行メカニズムが必要

*契約とライセンス*
- 明示的なIP保護条項
- 使用監視の権利
- 監査機能
- 罰則規定

## 検出方法

**クエリパターン分析**

*統計的検出*
- クエリ分布を分析
- 通常の使用パターンと比較
- 抽出の署名を識別
- 異常な動作にフラグを立てる

*行動分析*
- クエリシーケンスを監視
- 体系的な探索を検出
- 境界探索を識別
- カバレッジパターンを追跡

**ウォーターマーク検出**

*出力ウォーターマーク*
- 特徴的な動作を検出
- モデルの系統を識別
- 所有権の主張をサポート
- 事前の埋め込みが必要

*フィンガープリンティング*
- 独自の行動署名
- モデル間を区別
- コピーと派生物を識別
- 非侵襲的な検出

**モデル比較**

*機能テスト*
- テストセットでの予測を比較
- 統計的類似性測定
- 動作マッチング分析
- 疑わしいモデルへのアクセスが必要

## 実世界の例と研究

**ML API抽出（Tramèr et al., 2016）**
- 本番環境のML APIの抽出を実証
- BigML、Amazon MLモデルの複製に成功
- 限定的なクエリで高い忠実度を達成
- モデル窃取の基礎研究

**暗号化API攻撃**
- ニューラルネットワーク分類器を抽出
- 方程式解法アプローチを示した
- 一部のアーキテクチャで完全な抽出を達成
- 理論的脆弱性を強調

**BERTモデル抽出（Krishna et al., 2019）**
- 蒸留を通じてBERT様モデルを抽出
- タスク固有のデータで高いパフォーマンスを達成
- 言語モデルの脆弱性を実証
- 改善された防御につながった

**画像分類器の抽出**
- 画像分類器の抽出に成功
- 転移学習アプローチが効果的
- 能動学習がクエリ要件を削減
- API設計への業界への影響

## 他の攻撃との関係

**[モデル反転](Model-Inversion.md)**
- モデル窃取が反転のための代替モデルを作成
- ホワイトボックス反転攻撃を可能にする
- 補完的な攻撃技術
- プライバシーへの影響が複合化

**メンバーシップ推論**
- 類似のクエリベースの攻撃方法論
- 異なる主要目的
- 防御メカニズムを共有する可能性
- より広範なプライバシー攻撃の一部

**敵対的サンプル**
- 窃取されたモデルが敵対的サンプル作成を可能にする
- サンプルは元のモデルに転移することが多い
- 代替モデルが攻撃開発環境を提供
- モデル窃取の主要な動機

**データポイズニング**
- 異なる攻撃ベクトル（訓練 vs 推論）
- 両方ともMLシステムの整合性をターゲット
- 複雑な方法で相互作用する可能性
- 包括的な脅威モデルの一部

## 影響評価

**ビジネスへの影響**

*財務的損失*
- 開発投資が損なわれる
- ライセンス収入が減少
- 競争優位性が失われる
- 執行のための法的コスト

*評判への損害*
- セキュリティ侵害の認識
- 顧客の信頼の侵食
- 市場地位への影響
- 規制当局の監視

**セキュリティへの影響**

*連鎖攻撃*
- 敵対的サンプル生成を可能にする
- プライバシー攻撃を促進
- 回避技術をサポート
- セキュリティリスクを複合化

*長期的な露出*
- 窃取されたモデルは無期限に存続
- 将来の脆弱性が悪用可能
- 継続的な攻撃の実現
- 修復が困難

## 緩和のベストプラクティス

**モデルプロバイダー向け**

*API設計*
- 応答の情報を最小化
- 堅牢なレート制限を実装
- 疑わしいパターンを監視
- 予測APIの代替案を検討

*モデル保護*
- ウォーターマーキングを実装
- モデルの複雑性を検討
- アンサンブルアプローチを使用
- 抽出耐性を評価

*検出と対応*
- 異常検出をデプロイ
- クエリをログに記録して分析
- インシデント対応を確立
- 執行アクションを計画

**組織向け**

*リスク評価*
- モデルの価値と露出を評価
- 攻撃の可能性を評価
- 攻撃者の能力を考慮
- 脅威モデルを文書化

*セキュリティ管理*
- 多層防御を実装
- セキュリティと有用性のバランス
- 定期的なセキュリティレビュー
- 新しい脅威に基づいて更新

*法的準備*
- 明確な利用規約
- IP保護の文書化
- 執行能力
- 証拠の保全

## 規制および法的考慮事項

**知的財産法**
- 営業秘密保護が適用される可能性
- モデルの著作権に関する考慮事項
- 特許保護の可能性
- 契約による執行

**コンピュータ詐欺法**
- 不正アクセスに関する考慮事項
- 利用規約違反
- 刑事および民事責任
- 管轄区域による違い

**新興AI規制**
- AI法におけるセキュリティ要件
- 透明性義務
- リスク評価要件
- 文書化基準

## 今後の展望

**攻撃の進化**
- より効率的な抽出技術
- 基盤モデル固有の攻撃
- 自動化された攻撃開発
- クロスモデル攻撃転移

**防御の進歩**
- 改善されたウォーターマーキング方法
- より良い異常検出
- プライバシー保護API
- 理論的セキュリティ保証

**業界の対応**
- 標準化されたセキュリティプラクティス
- 認証要件
- 業界協力
- 規制遵守

モデル窃取は、機械学習システムをサービスとしてデプロイする組織にとって根本的な課題を表しています。AIモデルがより価値が高く広く展開されるようになるにつれて、有用な機能を維持しながら抽出攻撃から保護するには、慎重なバランスと継続的な警戒が必要です。

## 参考文献

- [USENIX Security: Stealing Machine Learning Models via Prediction APIs](https://www.usenix.org/conference/usenixsecurity16/technical-sessions/presentation/tramer)
- [arXiv: Model Extraction and Defenses](https://arxiv.org/abs/1711.01768)
- [ACM CCS: High Accuracy and High Fidelity Extraction](https://dl.acm.org/doi/10.1145/3319535.3363210)
- [IEEE S&P: CloudLeak - Large-Scale Deep Learning Model Stealing](https://ieeexplore.ieee.org/document/9152791)
- [NeurIPS: Prediction Poisoning - Towards Defenses Against Model Stealing](https://papers.nips.cc/paper/2020/hash/prediction-poisoning)
- [OWASP: Machine Learning Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/)
- [Microsoft: Threat Modeling AI/ML Systems](https://docs.microsoft.com/en-us/security/engineering/threat-modeling-aiml)
- [Google: ML Security Best Practices](https://cloud.google.com/architecture/mlops-continuous-delivery-and-automation-pipelines-in-machine-learning)