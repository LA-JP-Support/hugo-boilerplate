{{ define "main" }}
<style>
  /* Hero Carousel Styles */
  .hero-carousel {
    position: relative;
    width: 100%;
  }
  
  .hero-slide {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.8s ease-in-out, visibility 0.8s ease-in-out;
  }
  
  .hero-slide.active {
    position: relative;
    opacity: 1;
    visibility: visible;
  }
  
  .hero-slide h1,
  .hero-slide p,
  .hero-slide .cta-buttons {
    animation: none;
  }
  
  .hero-slide.active h1 {
    animation: slideInDown 0.8s ease-out;
  }
  
  .hero-slide.active p {
    animation: slideInUp 0.8s ease-out 0.1s both;
  }
  
  .hero-slide.active .cta-buttons {
    animation: slideInUp 0.8s ease-out 0.2s both;
  }
  
  /* Carousel Indicators */
  .hero-indicators {
    display: flex;
    justify-content: center;
    gap: 12px;
    margin-top: 2rem;
  }
  
  .hero-indicator {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.4);
    border: 2px solid rgba(255, 255, 255, 0.6);
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .hero-indicator:hover {
    background: rgba(255, 255, 255, 0.6);
  }
  
  .hero-indicator.active {
    background: white;
    border-color: white;
    transform: scale(1.2);
  }
  
  /* Gradient Themes for Slides */
  .antigravity-hero.gradient-support {
    background: linear-gradient(135deg, 
      #2a3d78 0%, 
      #3a2d65 25%, 
      #8b4db5 50%, 
      #2d6da4 75%, 
      #0097a9 100%);
  }
  
  .antigravity-hero.gradient-content {
    background: linear-gradient(135deg, 
      #0d4f4f 0%, 
      #1a5c45 25%, 
      #2d8b6e 50%, 
      #1e6a7a 75%, 
      #0097a9 100%);
  }
  
  .dark .antigravity-hero.gradient-support {
    background: linear-gradient(135deg, 
      #0a0f2f 0%, 
      #12102d 25%, 
      #2a1a4b 50%, 
      #06344a 75%, 
      #023a3a 100%);
  }
  
  .dark .antigravity-hero.gradient-content {
    background: linear-gradient(135deg, 
      #021a1a 0%, 
      #0a2a20 25%, 
      #0f3d2d 50%, 
      #0a2a35 75%, 
      #023a3a 100%);
  }

  /* Carousel Navigation Arrows */
  .hero-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
    width: 48px;
    height: 48px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    z-index: 20;
    backdrop-filter: blur(4px);
  }
  
  .hero-nav:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: translateY(-50%) scale(1.1);
  }
  
  .hero-nav-prev {
    left: 20px;
  }
  
  .hero-nav-next {
    right: 20px;
  }
  
  @media (max-width: 768px) {
    .hero-nav {
      width: 36px;
      height: 36px;
    }
    .hero-nav-prev {
      left: 10px;
    }
    .hero-nav-next {
      right: 10px;
    }
  }

  /* Antigravity Hero Styles */
  @keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }
  @keyframes float {
    0%, 100% { transform: translate(0px, 0px); }
    25% { transform: translate(30px, -50px); }
    50% { transform: translate(-20px, -100px); }
    75% { transform: translate(-50px, -50px); }
  }
  @keyframes pulse {
    0%, 100% { opacity: 0.6; }
    50% { opacity: 1; }
  }
  @keyframes slideInDown {
    from { opacity: 0; transform: translateY(-50px); }
    to { opacity: 1; transform: translateY(0); }
  }
  @keyframes slideInUp {
    from { opacity: 0; transform: translateY(50px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  .antigravity-hero {
    background: linear-gradient(135deg, 
      #2a3d78 0%, 
      #3a2d65 25%, 
      #8b4db5 50%, 
      #2d6da4 75%, 
      #0097a9 100%);
    background-size: 400% 400%;
    animation: gradientShift 12s ease infinite;
    min-height: 50vh;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
    transition: background 1s ease-in-out;
  }
  
  /* Background Image Layer with darker overlay */
  .hero-background-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
    overflow: hidden;
  }
  
  .hero-background-image::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.4);
    z-index: 2;
  }
  
  .hero-background-image img,
  .hero-background-image video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: 70% center;
    opacity: 0;
    mix-blend-mode: overlay;
    transition: opacity 0.8s ease-in-out;
    z-index: 1;
  }
  
  .hero-background-image .hero-bg-media.active {
    opacity: 0.45;
  }
  
  .dark .hero-background-image .hero-bg-media.active {
    opacity: 0.35;
  }
  
  /* Floating Orbs */
  .antigravity-hero::before {
    content: '';
    position: absolute;
    top: -10%;
    left: -5%;
    width: 500px;
    height: 500px;
    background: radial-gradient(circle, rgba(255,255,255,0.08) 0%, transparent 70%);
    border-radius: 50%;
    animation: float 25s ease-in-out infinite;
    filter: blur(60px);
    z-index: 2;
  }
  
  .antigravity-hero::after {
    content: '';
    position: absolute;
    bottom: -10%;
    right: -5%;
    width: 400px;
    height: 400px;
    background: radial-gradient(circle, rgba(255,255,255,0.08) 0%, transparent 70%);
    border-radius: 50%;
    animation: float 30s ease-in-out infinite reverse;
    filter: blur(60px);
    z-index: 2;
  }
  
  /* Glow Effect */
  .hero-glow {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 4;
  }
  
  .hero-glow-orb {
    position: absolute;
    width: 400px;
    height: 400px;
    background: radial-gradient(circle, rgba(255, 255, 255, 0.12) 0%, transparent 70%);
    border-radius: 50%;
    filter: blur(80px);
    transform: translate(-50%, -50%);
    transition: left 0.1s ease-out, top 0.1s ease-out;
    animation: pulse 3s ease-in-out infinite;
  }
  
  /* Content */
  .hero-content {
    position: relative;
    z-index: 10;
    text-shadow: 0 4px 20px rgba(0,0,0,0.5);
  }
  
  .hero-content h1 {
    animation: slideInDown 0.8s ease-out;
  }
  
  .hero-content p {
    animation: slideInUp 0.8s ease-out 0.1s both;
  }
  
  .hero-content .cta-buttons {
    animation: slideInUp 0.8s ease-out 0.2s both;
  }
  
  /* Dark mode adjustments */
  .dark .antigravity-hero {
    background: linear-gradient(135deg, 
      #0a0f2f 0%, 
      #12102d 25%, 
      #2a1a4b 50%, 
      #06344a 75%, 
      #023a3a 100%);
  }
</style>

<div class="antigravity-hero gradient-support" id="antigravityHero" data-gradients="{{ if .Params.hero_slides }}{{ range $index, $slide := .Params.hero_slides }}{{ if $index }},{{ end }}{{ $slide.gradient | default "support" }}{{ end }}{{ end }}" data-backgrounds="{{ if .Params.hero_slides }}{{ range $index, $slide := .Params.hero_slides }}{{ if $index }},{{ end }}{{ $slide.background_image | default $slide.background_video | default "/images/hero-customer-support.jpg" }}{{ end }}{{ end }}" data-background-types="{{ if .Params.hero_slides }}{{ range $index, $slide := .Params.hero_slides }}{{ if $index }},{{ end }}{{ if $slide.background_video }}video{{ else }}image{{ end }}{{ end }}{{ end }}">
  <!-- Background Media -->
  <div class="hero-background-image">
    {{ if .Params.hero_slides }}
      {{ range $index, $slide := .Params.hero_slides }}
        {{ if $slide.background_video }}
          <video class="hero-bg-media{{ if eq $index 0 }} active{{ end }}" data-slide="{{ $index }}" src="{{ $slide.background_video }}" autoplay loop muted playsinline preload="auto"></video>
        {{ else }}
          <img class="hero-bg-media{{ if eq $index 0 }} active{{ end }}" data-slide="{{ $index }}" src="{{ $slide.background_image | default "/images/hero-customer-support.jpg" }}" alt="Hero Background" loading="eager">
        {{ end }}
      {{ end }}
    {{ else }}
      <img class="hero-bg-media active" src="/images/hero-customer-support.jpg" alt="Hero Background" loading="eager">
    {{ end }}
  </div>
  
  <!-- Glow Effect -->
  <div class="hero-glow" id="heroGlow">
    <div class="hero-glow-orb" id="heroGlowOrb"></div>
  </div>
  
  <!-- Content -->
  <div class="relative isolate z-10 w-full">
    <div class="wrapper py-16 sm:py-20">
      <div class="hero-content mx-auto max-w-3xl text-center">
        
        {{ if .Params.hero_slides }}
        <!-- Carousel Navigation Arrows -->
        <button class="hero-nav hero-nav-prev" onclick="prevSlide()" aria-label="Previous slide">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
          </svg>
        </button>
        <button class="hero-nav hero-nav-next" onclick="nextSlide()" aria-label="Next slide">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
          </svg>
        </button>
        
        <!-- Hero Carousel -->
        <div class="hero-carousel" id="heroCarousel">
          {{ range $index, $slide := .Params.hero_slides }}
          <div class="hero-slide{{ if eq $index 0 }} active{{ end }}" data-slide="{{ $index }}">
            <h1 class="text-5xl font-semibold tracking-tight text-balance text-white drop-shadow-lg sm:text-7xl">
              {{ $slide.heading | safeHTML }}
            </h1>
            
            {{ if $slide.description }}
            <p class="mt-9 text-lg font-medium text-pretty text-white drop-shadow-md sm:text-xl/8">
              {{ $slide.description | safeHTML }}
            </p>
            {{ end }}
            
            {{ if or $slide.cta_primary $slide.cta_secondary }}
            <div class="cta-buttons mt-9 flex flex-wrap items-center justify-center gap-x-6 gap-y-4">
              {{ if $slide.cta_primary }}
              <a href="{{ $slide.cta_primary.url }}" 
                 class="rounded-md bg-white px-4 py-2.5 text-sm font-semibold text-indigo-600 shadow-lg hover:bg-gray-50 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white transition-all hover:scale-105">
                {{ $slide.cta_primary.text }}
              </a>
              {{ end }}
              {{ if $slide.cta_secondary }}
              <a href="{{ $slide.cta_secondary.url }}" 
                 class="text-sm font-semibold text-white hover:text-white/80 transition-colors drop-shadow-md">
                {{ $slide.cta_secondary.text }} <span aria-hidden="true">→</span>
              </a>
              {{ end }}
            </div>
            {{ end }}
          </div>
          {{ end }}
        </div>
        
        <!-- Carousel Indicators -->
        <div class="hero-indicators" id="heroIndicators">
          {{ range $index, $slide := .Params.hero_slides }}
          <button class="hero-indicator{{ if eq $index 0 }} active{{ end }}" 
                  data-slide="{{ $index }}" 
                  onclick="goToSlide({{ $index }})"
                  aria-label="Go to slide {{ add $index 1 }}"></button>
          {{ end }}
        </div>
        
        {{ else }}
        <!-- Single Hero (Fallback) -->
        {{ if .Params.hero_heading }}
          <h1 class="text-5xl font-semibold tracking-tight text-balance text-white drop-shadow-lg sm:text-7xl">
            {{ .Params.hero_heading }}
          </h1>
        {{ else }}
          <h1 class="text-5xl font-semibold tracking-tight text-balance text-white drop-shadow-lg sm:text-7xl">
            {{ .Title }}
          </h1>
        {{ end }}

        {{ if .Params.hero_description }}
          <p class="mt-9 text-lg font-medium text-pretty text-white drop-shadow-md sm:text-xl/8">
            {{ .Params.hero_description | safeHTML }}
          </p>
        {{ else if .Description }}
          <p class="mt-9 text-lg font-medium text-pretty text-white drop-shadow-md sm:text-xl/8">
            {{ .Description }}
          </p>
        {{ end }}

        {{ if or .Params.cta_primary .Params.cta_secondary }}
          <div class="cta-buttons mt-9 flex flex-wrap items-center justify-center gap-x-6 gap-y-4">
            {{ if .Params.cta_primary }}
              <a href="{{ .Params.cta_primary.url }}" 
                 class="rounded-md bg-white px-4 py-2.5 text-sm font-semibold text-indigo-600 shadow-lg hover:bg-gray-50 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white transition-all hover:scale-105">
                {{ .Params.cta_primary.text }}
              </a>
            {{ end }}
            {{ if .Params.cta_secondary }}
              <a href="{{ .Params.cta_secondary.url }}" 
                 class="text-sm font-semibold text-white hover:text-white/80 transition-colors drop-shadow-md">
                {{ .Params.cta_secondary.text }} <span aria-hidden="true">→</span>
              </a>
            {{ end }}
          </div>
        {{ end }}
        {{ end }}

        <!-- Hero Image -->
        {{ if .Params.hero_image }}
          <div class="mt-16 flow-root sm:mt-20">
            <div class="rounded-xl bg-white/10 backdrop-blur-sm p-2 ring-1 ring-inset ring-white/20 lg:-m-4 lg:rounded-2xl lg:p-4">
              <img src="{{ .Params.hero_image }}" 
                   alt="{{ .Params.hero_image_alt | default "Hero Image" }}" 
                   class="w-full rounded-md shadow-2xl ring-1 ring-white/10">
            </div>
          </div>
        {{ end }}
      </div>
    </div>
  </div>
</div>

<!-- Features Section -->
{{ if and .Params.detailed_features .Params.detailed_features.enable }}
  {{ partial "sections/features/with_alternating_sections.html" (dict
    "heading" .Params.detailed_features.heading
    "description" .Params.detailed_features.description
    "features" .Params.detailed_features.items
    "layoutSize" "balanced"
    "headingClass" "text-4xl font-bold tracking-tight text-gray-900 sm:text-5xl"
    "descriptionClass" "mt-6 text-xl leading-8 text-gray-600"
    "page" .
  ) }}
{{ else if .Params.features }}
  <div class="py-24 sm:py-32 bg-white dark:bg-gray-900">
    <div class="wrapper">
      <div class="mx-auto max-w-2xl lg:text-center mb-16">
        {{ if .Params.features_heading }}
          <h2 class="text-base font-semibold leading-7 text-indigo-600 dark:text-indigo-400">{{ .Params.features_heading }}</h2>
        {{ end }}
        {{ if .Params.features_title }}
          <p class="mt-2 text-3xl font-bold tracking-tight text-gray-900 dark:text-white sm:text-4xl">
            {{ .Params.features_title }}
          </p>
        {{ end }}
        {{ if .Params.features_description }}
          <p class="mt-6 text-lg leading-8 text-gray-600 dark:text-gray-400">
            {{ .Params.features_description }}
          </p>
        {{ end }}
      </div>
      
      <div class="mx-auto max-w-7xl">
        <dl class="grid max-w-xl grid-cols-1 gap-x-8 gap-y-10 lg:max-w-none lg:grid-cols-3 lg:gap-y-16">
          {{ range .Params.features }}
            <div class="relative pl-16">
              <dt class="text-base font-semibold leading-7 text-gray-900 dark:text-white">
                {{ if .icon }}
                  <div class="absolute left-0 top-0 flex h-10 w-10 items-center justify-center rounded-lg bg-indigo-600">
                    <svg class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" d="{{ .icon }}" />
                    </svg>
                  </div>
                {{ end }}
                {{ .name }}
              </dt>
              <dd class="mt-2 text-base leading-7 text-gray-600 dark:text-gray-400">
                {{ .description }}
              </dd>
            </div>
          {{ end }}
        </dl>
      </div>
    </div>
  </div>
{{ end }}

<!-- Content from Markdown -->
{{ if .Content }}
  <div class="py-16 bg-gray-50 dark:bg-gray-800">
    <div class="wrapper">
      <div class="prose prose-lg dark:prose-invert mx-auto max-w-3xl">
        {{ .Content }}
      </div>
    </div>
  </div>
{{ end }}

<script>
// Hero Carousel Functions
let currentSlide = 0;
let slideCount = 0;
let autoSlideInterval = null;
let gradients = [];
let backgrounds = [];
let backgroundTypes = [];
const AUTO_SLIDE_DELAY = 6000; // 6 seconds

function initCarousel() {
  const slides = document.querySelectorAll('.hero-slide');
  slideCount = slides.length;
  
  // Get gradient, background, and type data
  const hero = document.getElementById('antigravityHero');
  if (hero) {
    if (hero.dataset.gradients) {
      gradients = hero.dataset.gradients.split(',');
    }
    if (hero.dataset.backgrounds) {
      backgrounds = hero.dataset.backgrounds.split(',');
    }
    if (hero.dataset.backgroundTypes) {
      backgroundTypes = hero.dataset.backgroundTypes.split(',');
    }
  }
  
  if (slideCount > 1) {
    startAutoSlide();
    
    // Pause on hover
    const carousel = document.getElementById('heroCarousel');
    if (carousel) {
      carousel.addEventListener('mouseenter', stopAutoSlide);
      carousel.addEventListener('mouseleave', startAutoSlide);
    }
  }
}

function updateGradient(index) {
  const hero = document.getElementById('antigravityHero');
  if (!hero || gradients.length === 0) return;
  
  // Remove all gradient classes
  hero.classList.remove('gradient-support', 'gradient-content');
  
  // Add the appropriate gradient class
  const gradient = gradients[index] || 'support';
  hero.classList.add('gradient-' + gradient);
}

function updateBackground(index) {
  const allMedia = document.querySelectorAll('.hero-bg-media');
  allMedia.forEach((media, i) => {
    const slideIndex = parseInt(media.dataset.slide);
    if (slideIndex === index) {
      media.classList.add('active');
      // 動画の場合は再生位置をリセット
      if (media.tagName === 'VIDEO') {
        media.currentTime = 0;
      }
    } else {
      media.classList.remove('active');
    }
  });
}

function goToSlide(index) {
  const slides = document.querySelectorAll('.hero-slide');
  const indicators = document.querySelectorAll('.hero-indicator');
  
  if (index < 0) index = slideCount - 1;
  if (index >= slideCount) index = 0;
  
  slides.forEach((slide, i) => {
    slide.classList.toggle('active', i === index);
  });
  
  indicators.forEach((indicator, i) => {
    indicator.classList.toggle('active', i === index);
  });
  
  // Update gradient and background
  updateGradient(index);
  updateBackground(index);
  
  currentSlide = index;
  resetAutoSlide();
}

function nextSlide() {
  goToSlide(currentSlide + 1);
}

function prevSlide() {
  goToSlide(currentSlide - 1);
}

function startAutoSlide() {
  if (autoSlideInterval) return;
  autoSlideInterval = setInterval(nextSlide, AUTO_SLIDE_DELAY);
}

function stopAutoSlide() {
  if (autoSlideInterval) {
    clearInterval(autoSlideInterval);
    autoSlideInterval = null;
  }
}

function resetAutoSlide() {
  stopAutoSlide();
  startAutoSlide();
}

// Initialize carousel when DOM is ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initCarousel);
} else {
  initCarousel();
}
</script>

<script>
(function() {
  'use strict';
  
  // Glow Orb Effect
  function setupGlowOrb() {
    const glowOrb = document.getElementById('heroGlowOrb');
    const heroGlow = document.getElementById('heroGlow');
    
    if (!glowOrb || !heroGlow) return;
    
    document.addEventListener('mousemove', function(e) {
      const glowRect = heroGlow.getBoundingClientRect();
      const relativeX = e.clientX - glowRect.left;
      const relativeY = e.clientY - glowRect.top;
      
      requestAnimationFrame(function() {
        glowOrb.style.left = relativeX + 'px';
        glowOrb.style.top = relativeY + 'px';
      });
    });
  }
  
  // Initialize
  document.addEventListener('DOMContentLoaded', function() {
    setupGlowOrb();
  });
})();
</script>
{{ end }}
